<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../styles/styles.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;0,600;0,700;0,800;1,400;1,500;1,600;1,700;1,800&display=swap"
      rel="stylesheet"
    />
    <title>Chainlink Price Feed</title>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
  </head>
  <body>
    <header id="header">
      <section class="container header-content">
        <div class="header-content-title">
          <img
            src="assets/gopher.svg"
            alt="A - Golang Gopher @clipartmax.com"
          />
          <h1>Chainlink Price Feed com Go</h1>
        </div>

        <div class="controls">
          <select id="currency-select">
            <option value="brl">BRL</option>
            <option value="usd">USD</option>
          </select>
        </div>
      </section>
    </header>

    <div class="container" id="main">
      <div
        id="price-list-container"
        class="price-list"
        hx-get="/prices/all/brl"
        hx-trigger="load"
        hx-swap="innerHTML"
        hx-indicator="#loading-indicator"
      ></div>

      <div id="loading-indicator" class="skeleton-list htmx-indicator">
        <div class="skeleton-card"></div>
        <div class="skeleton-card"></div>
        <div class="skeleton-card"></div>
        <div class="skeleton-card"></div>
        <div class="skeleton-card"></div>
        <div class="skeleton-card"></div>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const currencySelect = document.getElementById("currency-select");
        const priceListContainer = document.getElementById(
          "price-list-container"
        );

        currencySelect.addEventListener("change", function () {
          const selectedCurrency = this.value;
          const newUrl = `/prices/all/${selectedCurrency}`;

          priceListContainer.setAttribute("hx-get", newUrl);

          htmx.ajax("GET", newUrl, {
            target: "#price-list-container",
            swap: "innerHTML",
          });
        });
      });
    </script>
  </body>
</html>
